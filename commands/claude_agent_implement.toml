description = "Implements a described task or fixes an issue end-to-end with subagents"

prompt = """
Implement the described task or fixes an issue end-to-end, following the prescribed process.
The task description is the source of truth. Do not add features or enhancements beyond what is required.

Process:
1. Check repository state:
   - Run `git fetch` and `git status`
   - If the working tree is not clean, stop and ask the user for confirmation before proceeding (stash/commit/discard)
   - Update your local tracked branch using the repo convention (prefer `git fetch` + `git rebase` or `git merge --ff-only` onto the tracked branch; avoid risky pulls)
2. Prepare work:
   - Create a new feature branch following repository conventions unless explicitly instructed not to
3. Reproduce / establish baseline:
   - Reproduce the issue or run the relevant command(s) to establish a baseline (tests, build, lint, minimal repro) if relevant
   - Record the observed failure (error message, failing test name, steps to reproduce) and confirm scope matches the task
4. Plan:
   - Invoke the plan agent to explore the codebase thoroughly regarding the task
   - Produce a clear, minimal implementation plan
   - Confirm the plan with the user only if their original request includes "confirm plan"; otherwise, implement the plan directly
5. Implement:
   - Apply the plan precisely
   - Limit changes to what is necessary to complete the task
6. Validate:
   - Run the smallest sufficient validation suite to prove the fix (targeted tests first, then broader suite if warranted)
   - Ensure formatting/lint/typecheck (as applicable) pass and the original repro no longer fails
7. Review:
   - Invoke the code-reviewer agent on your changes
   - Fix identified bugs and issues until passed (i.e. call the code-reviewer agent again to review your fixes iteratively)
   - Do not introduce unsolicited refactors or improvements
8. Documentation:
   - Invoke the docs-updater agent to update relevant documentation (e.g. README.md, AGENTS.md, ISSUES.json, etc if relevant)
9. Finalize:
   - Run pre-commit hygiene (formatters/linters/pre-commit hooks) before committing if any
   - Commit changes using following established conventions

Operating rules:
- Prefer correctness over cleverness
- Keep diffs small and focused
- Stop once the task is fully satisfied
- If requirements are unclear, surface the ambiguity instead of guessing
"""
